<!DOCTYPE html>
<html>
<head>
    <title>ISSP User Edit</title>
    <!-- Custom styles for this template -->
    <link href="/stylesheets/sb-admin-2.min.css" rel="stylesheet">
    <!-- Custom styles for this page -->
    <link href="/vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/stylesheets/sd-admin_custom.css">
    <link rel="stylesheet" href="/stylesheets/user_profile.css">
</head>
<body id="page-top">
    <!-- Page Wrapper -->
    <div id="wrapper">
        <%- include('./partials/dashboard_side_nav.ejs') %>
            <!-- Content Wrapper -->
            <div id="content-wrapper" class="d-flex flex-column">
                <!-- Main Content -->
                <div id="content">
                    <%- include('./partials/dashboard_top_nav.ejs') %> 
                    <!-- Begin Page Content -->
                    <div class="container-fluid">
                        <div class="card col-md-5 mx-auto cus-login">
                            <div class="card-body align-middle">
                                <h2>System Settings</h2>
                                <div>
                                    <%- include('partials/messages.ejs') %>
                                    <form method="POST" action="/system/update">
                                        <div class="form-group">
                                            <label for="deadline">Next Deadline:</label>
                                            <input class="form-control" type="date" value="" id="deadline" name="deadline">
                                        </div>
                                        <div class="form-group">
                                            <label for="tag_year">Current Submissions assign to:</label>
                                            <select  class="form-control" id ="tag_year" name="submission_year">
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <select  class="form-control" id ="tag_term" name="submission_term">
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <input class="btn bcit-login" id="regbtn" type="submit" value="Update" style="width: 100%">
                                        </div>
                                    </form>
                                
                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- /.container-fluid -->
                </div>
                <!-- End of Main Content -->
            </div>
            <!-- End of Content Wrapper -->
    </div>
    <!-- End of Page Wrapper -->

    <!-- Bootstrap core JavaScript-->
    <script src="/vendor/jquery/jquery.min.js"></script>
    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="/vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="/js/sb-admin-2.min.js"></script>

</body>
<script>
    var submission_tag = <%- JSON.stringify(tag) %>
    function formatDate(date) {
        var d = new Date(date),
            month = '' + (d.getMonth() + 1),
            day = '' + d.getDate(),
            year = d.getFullYear();
        if (month.length < 2) 
            month = '0' + month;
        if (day.length < 2) 
            day = '0' + day;
        return [year, month, day].join('-');
    }

    // format the date received
    var deadline_formatted = formatDate(
        <%- JSON.stringify(deadline.month) %> + " " + 
        <%- JSON.stringify(deadline.day) %> + " " + 
        <%- JSON.stringify(deadline.year) %>
        )
    // set deadline on input field to data stored.
    document.getElementById("deadline").value = deadline_formatted;
    

    // dynamically generate option for submission year and set default value to data stored
    var temp_year = new Date().getFullYear();
    var year_list = [temp_year.toString(), (temp_year + 1).toString()]
    var select = document.getElementById('tag_year');
    var html = '';
    for (var i = 0; i < year_list.length; i++) {
        html += '<option value="' + year_list[i] + '">' + year_list[i] + '</option>'
    }
    select.innerHTML = html;
    select.value = submission_tag[0]

    // dynamically generate option for submission term and set default value to data stored
    var term_list = ["winter", "summer", "fall"]
    var select2 = document.getElementById('tag_term');
    var html2 = '';
    for (var i = 0; i < term_list.length; i++) {
        html2 += '<option value="' + term_list[i] + '">' + term_list[i] + '</option>'
    }
    select2.innerHTML = html2;
    select2.value = submission_tag[1]

</script>
</html>